/*!
 * Powered by uglifiyJS v2.6.1, Build by http://www.ossoft.cn
 * build time: Wed Jan 26 2022 08:58:01 GMT+0800 (China Standard Time)
*/
function dsToggle(){$(".hide_box").fadeToggle()}$(function(){function e(){$("#line-number").change(g),$("#customer-input-remove").click(function(){$("#bus-number").val(""),window.localStorage.removeItem("busNumber"),null!=$("#line-number option").get(0)&&($("#line-number option").get(0).selected=!0),g()}),$("#follow").bootstrapSwitch("state",!0)}var t,n,o,i=null,a=0,r=100,l=0,s=10,p=function(){d(),c(),m(),e(),y()},c=function(){var e=window.localStorage.getItem("lineNumber");if(e){var t=$('#line-number option[value="'+e+'"]');t.length>0&&$("#line-number").val(e),g()}var n=window.localStorage.getItem("busNumber");n&&(n=n.replace("DD",""),$("#bus-number").val(n))},d=function(){t=new BMap.Map("container"),t.addControl(new BMap.MapTypeControl),t.addControl(new BMap.GeolocationControl),t.centerAndZoom("\u5408\u80a5",15),t.enableScrollWheelZoom(!0),t.addTileLayer(new BMap.TrafficLayer)},g=function(){u();var e=$("#line-number").val();-1==e?$("#bus-number-div").removeClass("hide"):$("#bus-number-div").addClass("hide")},m=function(){var e=$("#line-number").val();if(window.localStorage.setItem("lineNumber",e),-1==e){var o=$("#bus-number").val();""!=$.trim(o)&&4==o.length&&(e="DD"+o,window.localStorage.setItem("busNumber",e))}return""==$.trim(e)||6!=e.length?(b(),!1):void $.ajax({url:"/rest/api/getBusNo&no="+e,type:"GET",dataType:"json",success:function(e){if(e){var o=e.code;if(200==o){var i=e.results,a=i.longitude,r=i.latitude,p=new BMap.Point(a,r);null==n?n=x(p,t):(l>s?(b(),n=x(p,t)):n.setPosition(p),l++),$("#follow").is(":checked")&&t.centerAndZoom(p,16)}else h(e.message)}},error:function(e){h("Server busy or error.")}})},h=function(e){b(),layer.open({content:e,skin:"msg",time:3}),a++,a>=r&&f()},u=function(){if(!i){var e=$("#timer").val();i&&clearInterval(i),i=setInterval(m,e),a=0}},f=function(){i&&(clearInterval(i),i=null,a=0)},x=function(e,t){o||(o=v("https://cdn.jsdelivr.net/gh/aiservice/cdn/bus/img/bus.png"));var n=new BMap.Marker(e,{icon:o}),i=new ComplexCustomOverlay(e,n);return t.addOverlay(i),i},b=function(){n&&(t.removeOverlay(n),t.removeOverlay(n.getMaker()),n=null),l=0},v=function(e){var t=new BMap.Icon(e,new BMap.Size(50,50),{});return t},y=function(){var e=".hide_box{position:fixed;left:0;top:0;right:0;bottom:0;z-index:9999;background-color:transparent;display:none} .v-modal-mask{background-color:#eee;position:absolute;left:0;right:0;top:0;bottom:0;-webkit-transition:opacity .3s;-o-transition:opacity .3s;transition:opacity .3s;opacity:1} .shang_box{position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%, -50%);-ms-transform:translate(-50%, -50%);transform:translate(-50%, -50%);border-radius:6px;background-color:#fff;padding:10px;z-index:1000;opacity:1;width:350px;text-align:center;border:1px dotted #dedede}.shang_box img{border:none;border-width:0}.dashang{display:block;width:100px;margin:5px auto;height:25px;line-height:25px;padding:10px;background-color:#E74851;color:#fff;text-align:center;text-decoration:none;border-radius:10px;font-weight:bold;font-size:16px;transition:all .3s}.dashang:hover{opacity:.8;padding:15px;font-size:18px}.shang_close{float:right;display:inline-block}.shang_logo{display:block;text-align:center;margin:20px auto}.shang_tit{width:100%;height:75px;text-align:center;line-height:66px;color:#a3a3a3;font-size:16px;font-family:'Microsoft YaHei';margin-top:7px;margin-right:2px}.shang_tit p{color:#a3a3a3;text-align:center;font-size:16px}.shang_payimg{width:140px;margin:0 auto;border-radius:3px;height:140px}.shang_payimg img{display:block;text-align:center;width:140px;height:140px}.pay_explain{text-align:center;margin:10px auto;font-size:12px;color:#545454};display:block;float:left;margin-top:5px;margin-right:14px}.shang_payselect{text-align:center;margin:0 auto;margin-top:40px;cursor:pointer;height:60px;width:280px}.shang_payselect .pay_item{display:inline-block;margin-right:10px;float:left}.shang_info{clear:both;margin-top: 20px;}.shang_info p,.shang_info a{color:#C3C3C3;text-align:center;font-size:12px;text-decoration:none;line-height:2em}hr{margin-top:20px;margin-bottom:20px;border:0;border-top:1px solid #eee}.content h3{margin-bottom:10px;font-size:24px;margin-top:20px;font-family:inherit;font-weight:500;line-height:1.1;color:inherit;text-align:center}";$("head").append($("<style>"+e+"</style>"));var t='<div style="position: fixed;bottom: 30px;left: 12px;"><a href="javascript:void(0)" onclick="dsToggle()" class="btn" style="padding: 5px;color: #ec7259;background-color: #fff;border-color: #ec7259;width: 30px;height: 30px;border-radius: 50%;"><span>\u8d5e</span></a></div>',n='<div class="hide_box"> <div class="v-modal-mask"></div> <div class="shang_box"> <a class="shang_close" href="javascript:void(0)" onclick="dsToggle()"><img src="https://imgs.aixifan.com/FhLvzt9HWUfEfdLc7OzhmCZDcKTY" alt="\u53d6\u6d88" /></a> <div class="shang_tit"> <p>\u611f\u8c22\u60a8\u7684\u652f\u6301\uff0c\u6211\u4f1a\u7ee7\u7eed\u52aa\u529b\u7684!</p> </div> <div class="shang_payimg"> <img src="https://imgs.aixifan.com/FjgIre1Ry11Oy3zmravfofNEN4YB" alt="\u626b\u7801\u652f\u6301" title="\u626b\u4e00\u626b" /> </div> <div class="shang_info"> <p>\u8bc6\u522b\u4e8c\u7ef4\u7801\u6216\u4fdd\u5b58\u5230\u76f8\u518c,\u6253\u5f00\u5fae\u4fe1</p> </div> </div> </div>';$("body").append(t+n)};p()});